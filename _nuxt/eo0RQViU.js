import{_ as E,r as i,s as I,c as d,a as s,m as w,v as M,F as h,n as S,u as O,d as b,p as k,t as m,o as g}from"./DemqZqsT.js";import{u as U}from"./9Ck5Jf7D.js";const J={setup(){const{languages:f}=U(),e=i("en-US"),v=i(""),a=i(""),c=i(""),l=i([]),n=i(!1),u=i(!1);let p;const H=async()=>{try{const o=await self.ai.languageModel.capabilities();console.log(o),p=await self.ai.languageModel.create({systemPrompt:"You are a multilingual assistant. You will teach students their desired language by conversing with them.",monitor(t){t.addEventListener("downloadprogress",r=>{console.log(`Downloaded ${r.loaded} of ${r.total} bytes.`)})}}),console.log(p)}catch(o){console.error("Failed to create language model session:",o),alert("The language model API is unavailable. Please try again later.")}};I(async()=>{try{await H();const o=JSON.parse(localStorage.getItem("conversationHistory")||"[]");l.value=o}catch(o){console.error("Error during initialization:",o)}});const R=()=>{T(async o=>{v.value=o,await A(o)})},A=async o=>{try{console.log(p),u.value=!0,a.value="";const t=await p.promptStreaming(o);for await(const r of t)a.value=r;u.value=!1,await _(a.value),C(o,{original:a.value,translated:c.value}),n.value&&x(c.value)}catch(t){console.error("Error fetching streaming response:",t),u.value=!1}},_=async o=>{try{const t=await self.translation.createTranslator({sourceLanguage:navigator.language.split("-")[0],targetLanguage:e.value.split("-")[0]});c.value=await t.translate(o)}catch(t){console.error("Error translating AI response:",t),c.value=o}},C=(o,t)=>{const r={user:o,assistant:t};l.value.push(r),localStorage.setItem("conversationHistory",JSON.stringify(l.value))},x=o=>{const t=new SpeechSynthesisUtterance(o);t.lang=e.value,speechSynthesis.speak(t)},L=()=>{const o="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(l.value,null,2)),t=document.createElement("a");t.setAttribute("href",o),t.setAttribute("download","conversation_history.json"),document.body.appendChild(t),t.click(),t.remove()},N=o=>{const t=o.target.files[0],r=new FileReader;r.onload=()=>{const y=JSON.parse(r.result);l.value=y,localStorage.setItem("conversationHistory",JSON.stringify(y))},r.readAsText(t)};function T(o){const t=new(window.SpeechRecognition||window.webkitSpeechRecognition);t.lang=navigator.language,t.interimResults=!1,t.maxAlternatives=1,t.onresult=r=>{const y=r.results[0][0].transcript;o(y)},t.onerror=r=>{console.error("Speech recognition error:",r.error),alert("Speech recognition failed. Please try again.")},t.start()}return{languages:f,selectedLanguage:e,spokenText:v,streamingResponse:a,translatedResponse:c,conversationHistory:l,autoSpeech:n,isStreaming:u,startRecognition:R,speak:x,downloadHistory:L,uploadHistory:N}}},V={class:"min-h-screen bg-gradient-to-b from-black via-gray-900 to-black py-10 text-white"},F={class:"max-w-2xl mx-auto bg-gray-800 p-6 rounded-lg shadow-lg"},P={class:"mb-6"},j=["value"],B={class:"mb-6 flex items-center"},D={class:"mb-6"},Y={class:"mb-6 flex justify-between"},z={class:"bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition cursor-pointer"},q={key:0,class:"mb-6"},G={class:"space-y-4 bg-gray-900 p-4 rounded-lg"},K={class:"text-sm text-gray-300"},Q={class:"text-sm text-blue-400"},W={class:"text-sm text-green-400"},X={key:1,class:"mb-6"},Z={class:"bg-gray-900 p-4 rounded-lg text-blue-300 text-sm"};function $(f,e,v,a,c,l){return g(),d("div",V,[s("div",F,[e[13]||(e[13]=s("h1",{class:"text-3xl font-semibold tracking-wide mb-6 text-center text-gray-100"},"Shake Lingo Conversational Assistant",-1)),s("div",P,[e[5]||(e[5]=s("label",{for:"language",class:"block text-sm font-medium text-gray-400 mb-2"},"Select Target Language",-1)),w(s("select",{id:"language","onUpdate:modelValue":e[0]||(e[0]=n=>a.selectedLanguage=n),class:"w-full bg-gray-900 text-gray-300 py-2 px-4 rounded-lg border border-gray-700 focus:outline-none focus:ring focus:ring-blue-500"},[(g(!0),d(h,null,S(a.languages,n=>(g(),d("option",{key:n.code,value:n.code},m(n.name),9,j))),128))],512),[[M,a.selectedLanguage]])]),s("div",B,[e[6]||(e[6]=s("label",{for:"autoSpeech",class:"text-sm font-medium text-gray-400"},"Auto Speak Responses",-1)),w(s("input",{id:"autoSpeech",type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=n=>a.autoSpeech=n),class:"ml-4 h-5 w-5 text-blue-500 bg-gray-900 border-gray-700 focus:ring focus:ring-blue-500 rounded-lg"},null,512),[[O,a.autoSpeech]])]),s("div",D,[s("button",{onClick:e[2]||(e[2]=(...n)=>a.startRecognition&&a.startRecognition(...n)),class:"w-full bg-gradient-to-r from-blue-500 via-teal-500 to-blue-500 text-white py-3 px-6 rounded-lg font-semibold shadow-md hover:shadow-lg hover:scale-105 transform transition"}," Speak ")]),s("div",Y,[s("button",{onClick:e[3]||(e[3]=(...n)=>a.downloadHistory&&a.downloadHistory(...n)),class:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition"}," Save History "),s("label",z,[e[7]||(e[7]=b(" Upload History ")),s("input",{type:"file",class:"hidden",onChange:e[4]||(e[4]=(...n)=>a.uploadHistory&&a.uploadHistory(...n))},null,32)])]),a.conversationHistory.length>0?(g(),d("div",q,[e[11]||(e[11]=s("h2",{class:"text-lg font-medium tracking-wide mb-4 text-gray-100"},"Conversation History",-1)),s("ul",G,[(g(!0),d(h,null,S(a.conversationHistory,(n,u)=>(g(),d("li",{key:u,class:"border-b border-gray-700 pb-4 last:border-b-0"},[s("p",K,[e[8]||(e[8]=s("strong",null,"You:",-1)),b(" "+m(n.user),1)]),s("p",Q,[e[9]||(e[9]=s("strong",null,"Assistant (Original):",-1)),b(" "+m(n.assistant.original),1)]),s("p",W,[e[10]||(e[10]=s("strong",null,"Assistant (Translated):",-1)),b(" "+m(n.assistant.translated),1)])]))),128))])])):k("",!0),a.isStreaming?(g(),d("div",X,[e[12]||(e[12]=s("h2",{class:"text-lg font-medium tracking-wide mb-4 text-gray-100"},"Streaming Response",-1)),s("div",Z,m(a.streamingResponse),1)])):k("",!0)])])}const oe=E(J,[["render",$]]);export{oe as default};
